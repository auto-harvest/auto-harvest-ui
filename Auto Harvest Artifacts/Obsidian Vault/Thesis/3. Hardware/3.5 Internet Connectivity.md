Reliable internet access is critical for the Auto Harvest system, enabling **remote control, telemetry, and integration with cloud services**. The current prototype connects to Wi-Fi using a lightweight pairing process, and securely publishes data to the cloud using the MQTT protocol over TLS.

---

#### üß∞ Pairing and Initial Setup

On first boot or after an EEPROM reset, the device checks for **stored SSID and password** entries via a custom EEPROM parser. If no credentials are found, the device enters **pairing mode**, indicated by a blinking LED and the message `"Pairing Mode"` shown on the LCD screen.

The pairing process follows these steps:

1. **User installs the Android app** and taps ‚ÄúPair Device‚Äù
    
2. The app prompts the user to **connect to a Wi-Fi AP called `ESP8266`**, hosted by the ESP-01 in AP mode
    
3. Once connected, the app displays all visible Wi-Fi networks scanned by the Arduino
    
4. The user selects one and submits their password via a `POST /pair` request, sent as a `FormData` body
    
5. If the credentials are valid, the ESP:
    
    - Responds with HTTP 200
        
    - Shuts down the access point
        
    - Stores the network configuration in EEPROM
        
6. The app then prompts the user to name and register the device, adding metadata like location and plant count
    

‚úÖ **Planned Upgrade**: In future versions, each device will generate a **custom AP SSID** and include a **QR code sticker** containing all pairing information ‚Äî making the onboarding process even more intuitive.

---

#### üîÅ Reconnection Logic and Fault Handling

Once paired, the ESP-01 automatically reconnects to the saved Wi-Fi on startup. If the connection drops, the `EspWiFi` library attempts to reconnect in the background. During disconnection:

- **All normal logic is paused** to avoid data loss or errors
    
- Once reconnected, publishing resumes without user intervention
    

A future enhancement will allow the device to **revert to AP mode** after a prolonged offline period and **notify the user via the mobile app**, offering re-pairing or diagnostics.

---

#### üîê Credential Storage

All credentials (SSID, password, and MQTT broker address) are stored in **EEPROM**. On boot, they‚Äôre loaded into a dedicated `AppContext` object to reduce EEPROM reads and enable fast in-memory access across the application.

---

#### ‚òÅÔ∏è Cloud Communication Protocol

Once online, the device connects to the backend using **MQTT over TLS**, ensuring both performance and security:

- Implemented via the **PubSubClient library**
    
- Communication is **fully encrypted**
    
- Supports publishing of sensor data and receiving of remote commands
    

While the ESP-01 serves well for prototyping, future production units will use **ESP32**, which will consolidate communication and control in a single chip ‚Äî removing the need for an external MCU.

---

#### üåç Production-Ready Expansion

While Wi-Fi is sufficient for **hobbyist and early-stage deployments**, future commercial/industrial versions will include:

- **Zigbee radio modules** for local mesh networking
    
- A central gateway hub with **Wi-Fi + 4G failover**
    
- Remote update and monitoring of multi-device farms
    

---

This connectivity stack ensures a balance between **low-cost flexibility** and **long-term scalability**, laying the groundwork for both consumer and enterprise applications.