The frontend of the Auto Harvest platform â€” built using React Native for Web â€” is deployed as static files to **Google Cloud Storage (GCS)**. This approach offers fast, scalable delivery and seamless integration with CI/CD pipelines and Cloudflare for global access and routing.

#### ğŸª£ Bucket Structure

We maintain two separate GCS buckets for static content:

- `auto-harvest-ui-prod`
    
- `auto-harvest-ui-stage`
    

This allows isolated deployment and testing workflows, ensuring changes can be staged before promotion to production.

#### âš™ï¸ Deployment Mechanism

Frontend files (`index.html`, `.js`, `.css`, assets) are built and uploaded via a **custom deployment script**, which handles syncing the output of the frontend build (`npm run export` or similar) to the appropriate bucket.

This script can be triggered either:

- Automatically through **GitHub Actions** during CI/CD pipelines, or
    
- Manually by collaborators for **rapid debugging or patch testing**
    

#### ğŸŒ Access and Proxying

Although the buckets are technically **publicly accessible**, their direct URLs are **obfuscated and never exposed to users**. Instead, access is routed through a **Cloudflare-managed subdomain**, which:

- Applies **URL rewrites** to support **React Router SPA navigation**
    
- Serves files via **Cloudflareâ€™s edge caching**
    
- Uses **Cloudflare CloudConnector** to route requests securely and efficiently to GCS
    

This configuration ensures fast loading times globally while enabling SPA behavior with fallback to `index.html` for unknown routes.

#### ğŸ”„ Cache Invalidation

Due to the nature of single-page applications, cache consistency is critical. After each deployment, we trigger a **full bucket invalidation** using `compute.urlMaps.invalidateCache`, ensuring updated JavaScript and CSS files are delivered immediately. Since the bucket contains only these critical assets, full invalidation is performant and predictable.

#### ğŸ” Security and Permissions

- **Read Access**: The bucket grants `allUsers` the minimal permission of `storage.objects.get`, allowing anyone to fetch static files directly if they know the URL. However, listing, editing, or deleting contents is fully restricted.
    
- **Write Access**: Only collaborators (via Google accounts) and the `GitHub Actions Runner` service account have mutation privileges (`write`, `delete`, `update`). This ensures secure, controlled deployment flows.