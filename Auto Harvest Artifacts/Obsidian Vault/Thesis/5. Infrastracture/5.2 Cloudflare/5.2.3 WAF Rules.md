To protect the Auto Harvest infrastructure from common web threats, automated scanners, and abusive behavior, we utilize **Cloudflare’s Web Application Firewall (WAF)**. Cloudflare’s WAF offers an advanced and easy-to-manage interface that lets us apply global protection rules at the DNS edge, before requests even reach our Google Cloud infrastructure.

#### 🛡️ Managed Rulesets

We rely on **Cloudflare’s prebuilt managed rulesets**, which are continuously updated to cover the most common and dangerous exploit patterns, including:

- SQL injection attempts
    
- Cross-site scripting (XSS) payloads
    
- Exploits targeting CMS platforms (e.g., WordPress, Joomla, Drupal)
    
- Malformed user-agents and uncommon HTTP methods
    

These rulesets are enabled globally with strict enforcement for all proxied subdomains.

#### 🚫 Path Pattern Filtering

We explicitly block access to known exploit probes and penetration test paths, including but not limited to:

- `/wp-login.php`
    
- `/phpmyadmin`
    
- `/.env`
    
- `/config.php`
    
- `/admin/`
    
- Any request path or query string that resembles automated vulnerability scanning attempts
    

This helps prevent automated enumeration and vulnerability scanning tools from probing our services.

#### 🤖 Bot Management

Cloudflare’s **Bot Management** engine is enabled to distinguish between **trusted crawlers** and **malicious or unknown bots**. This setup allows:

- **Search engine bots like Googlebot** to index our public frontend (important for SEO)
    
- Block/JS-challenge unknown or suspicious bots
    
- Visibility into bot traffic trends and behavior
    

#### ⚙️ Rate Limiting

To prevent abuse and brute-force-style attacks, a **rate limit** is enforced via WAF rules:

- If a single IP requests the same resource more than **20 times per minute**, their connection is temporarily throttled or challenged.
    
- This is especially useful for high-risk endpoints (e.g., `/api/login`, `/reporting`)
    

This balances user accessibility with protection against automated flooding or scraping.

#### 📊 Monitoring & Management

WAF event logs and request analytics are monitored **daily through the Cloudflare dashboard**, allowing for rapid detection of anomalies, blocked requests, and emerging threats. Adjustments to rules are made based on observed behavior trends and false positives.