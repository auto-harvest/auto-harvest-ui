Cloudflare functions as the **reverse proxy** for all public-facing services in the Auto Harvest infrastructure. This architectural role allows Cloudflare to act as an intermediary between clients and backend servers â€” handling DNS resolution, SSL termination, caching, and security inspection before forwarding requests to Google Cloud services.

#### ğŸ§­ Proxy Flow Overview

All application traffic follows this general route:

pgsql

CopyEdit

`Client â†’ Cloudflare (Edge Node) â†’ Google Load Balancer â†’ GKE Cluster / Bucket`

This design ensures:

- **Backend IP addresses remain hidden**
    
- **TLS traffic is terminated and inspected** at the Cloudflare edge
    
- Requests are **filtered, cached, or rewritten** before hitting our origin infrastructure
    

#### ğŸ” Routing and Rewrites

Cloudflare applies a set of routing rules and header rewrites to support:

- **Subdomain-based routing** (e.g., `api.`, `mqtt-`, etc.)
    
- **Single-page app (SPA) compatibility**, by rewriting unknown paths to `index.html` for the frontend
    
- **Development shortcuts**, such as bypassing cache using custom headers like `no-cache-baby`
    

These rewrites ensure frontend routing (React Router) behaves correctly even when reloading nested routes or deep-linking to components.

#### ğŸ”’ Security Benefits

By positioning Cloudflare as a reverse proxy:

- All **SSL/TLS connections are fully encrypted end-to-end**, using **Strict SSL mode**
    
- Only requests carrying Cloudflareâ€™s trusted certificate reach GCP, **preventing direct origin access**
    
- **Firewall rules and bot detection** are enforced before any resource consumption on Googleâ€™s side
    

#### âš™ï¸ Flexibility and Control

Cloudflareâ€™s reverse proxy also enables:

- Fast toggling of features like **â€œIâ€™m Under Attackâ€ mode**
    
- Real-time analytics on response codes, bot traffic, and cache performance
    
- Edge-side customization without needing to redeploy code or touch backend infrastructure
    

This configuration gives us centralized control over how external traffic is routed, protected, and optimized before reaching the core system.