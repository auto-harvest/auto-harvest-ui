Auto Harvest‚Äôs infrastructure was built with a **security-first philosophy**, emphasizing **early threat filtering, end-to-end encryption, abuse rate control, and real-time response mechanisms**. The system is designed to proactively **deflect attacks before they reach backend infrastructure**, preserving both performance and availability.

#### üõ°Ô∏è Multi-Layered Security Architecture

Security is enforced at multiple layers in the network:

1. **Cloudflare Edge (First Line of Defense)**
    
    - **WAF Rules** (see 5.2.3): Block known exploit patterns, bots, and scanners.
        
    - **Bot Management**: Allows trusted crawlers (Googlebot) while blocking unknown traffic.
        
    - **Rate Limiting**: Applies per-resource limits to prevent abuse (20 requests/minute threshold).
        
    - **IP Intelligence**: Cloudflare blocks IPs triggering known exploit paths (`.env`, `phpmyadmin`, etc.)
        
    - **SSL Enforcement**: Full (Strict) TLS chain; traffic without valid certs is rejected.
        
    - **‚ÄúI‚Äôm Under Attack‚Äù Mode**: Instantly enables CAPTCHA challenges for all clients during volumetric attacks.
        
2. **Google Cloud Network Layer**
    
    - All exposed services use **HTTPS Load Balancers** configured to only **trust traffic signed by Cloudflare‚Äôs certificates**.
        
    - **No direct access** to origin IPs or pods is allowed from the public internet.
        
3. **Kubernetes & Application Layer**
    
    - Stateless architecture (RESTful API, MQTT) reduces vulnerability to session hijacking or replay.
        
    - **Sensitive APIs** are rate-limited and monitored.
        
    - **Ingress logs** are inspected for anomalies and flagged paths.
        

#### üîê Certificate Trust and Origin Protection

We employ **Strict SSL mode** with Cloudflare-generated origin certificates, which ensures:

- **Only Cloudflare** can communicate with the origin server
    
- **No raw IP access** from unauthorized sources is possible
    
- **SSL pinning** (client-side) is supported in the mobile app to defend against MITM attacks
    

#### üö® Incident Response and Monitoring

- The team monitors **Cloudflare analytics and firewall events daily**, watching for traffic spikes, anomalies, and blocked paths.
    
- DNS changes, WAF rule edits, and rate-limit thresholds are tightly controlled and version-tracked.
    
- When malicious behavior is detected, response options include:
    
    - Toggling CAPTCHA challenge globally
        
    - Temporary IP bans
        
    - Cache purging and disabling CDN for specific assets
        

#### üß™ Resilience Through Simplicity

By separating services (e.g., API, MQTT) into their own endpoints and Load Balancers, we isolate blast radius during targeted attacks. In addition, leveraging **read-only buckets for static files** ensures the frontend can serve even during backend outages.