The backend is structured as a **modular Express.js application**, served under the `/api` namespace. Its core responsibilities are divided across **HTTP routes**, **WebSocket connections**, and **MQTT handlers** that communicate with firmware and frontend clients.

Key components initialized in `main.ts`:

- Express app with CORS and JSON parsing
    
- REST API routes (`/user`, `/controller`, `/logs`)
    
- Static asset handling (for firmware delivery or metadata files)
    
- WebSocket server via `socket.io`
    
- MQTT connection via `mqtt.js`
    
- MongoDB connection using `mongoose`
    

---

#### ðŸ§© API Endpoints Overview

| Route             | Method | Description                              |
| ----------------- | ------ | ---------------------------------------- |
| `/api/signup`     | POST   | Create a new user account                |
| `/api/login`      | POST   | Authenticate user, return JWT            |
| `/api/controller` | POST   | Register a new IoT controller            |
| `/api/controller` | GET    | List userâ€™s registered controllers       |
| `/api/logs`       | POST   | Ingest new sensor data from a controller |
| `/api/logs`       | GET    | Retrieve logs by controller, type, range |

Each route uses middleware like `auth.middleware.ts` and `jwt.middleware.ts` to:

- Validate and decode JWT tokens
    
- Attach `userId` to the request
    
- Confirm the user exists before passing control to the controller logic